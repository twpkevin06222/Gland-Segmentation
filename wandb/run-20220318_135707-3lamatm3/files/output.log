==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─ResNetEncoder: 1-1                     [-1, 3, 512, 512]         --
|    └─Conv2d: 2-1                       [-1, 64, 256, 256]        9,408
|    └─BatchNorm2d: 2-2                  [-1, 64, 256, 256]        128
|    └─ReLU: 2-3                         [-1, 64, 256, 256]        --
|    └─MaxPool2d: 2-4                    [-1, 64, 128, 128]        --
|    └─Sequential: 2-5                   [-1, 64, 128, 128]        --
|    |    └─BasicBlock: 3-1              [-1, 64, 128, 128]        73,984
|    |    └─BasicBlock: 3-2              [-1, 64, 128, 128]        73,984
|    └─Sequential: 2-6                   [-1, 128, 64, 64]         --
|    |    └─BasicBlock: 3-3              [-1, 128, 64, 64]         230,144
|    |    └─BasicBlock: 3-4              [-1, 128, 64, 64]         295,424
|    └─Sequential: 2-7                   [-1, 256, 32, 32]         --
|    |    └─BasicBlock: 3-5              [-1, 256, 32, 32]         919,040
|    |    └─BasicBlock: 3-6              [-1, 256, 32, 32]         1,180,672
|    └─Sequential: 2-8                   [-1, 512, 16, 16]         --
|    |    └─BasicBlock: 3-7              [-1, 512, 16, 16]         3,673,088
|    |    └─BasicBlock: 3-8              [-1, 512, 16, 16]         4,720,640
├─UnetDecoder: 1-2                       [-1, 16, 512, 512]        --
|    └─Identity: 2-9                     [-1, 512, 16, 16]         --
|    └─ModuleList: 2                     []                        --
|    |    └─DecoderBlock: 3-9            [-1, 256, 32, 32]         2,360,320
|    |    └─DecoderBlock: 3-10           [-1, 128, 64, 64]         590,336
|    |    └─DecoderBlock: 3-11           [-1, 64, 128, 128]        147,712
|    |    └─DecoderBlock: 3-12           [-1, 32, 256, 256]        46,208
|    |    └─DecoderBlock: 3-13           [-1, 16, 512, 512]        6,976
├─SegmentationHead: 1-3                  [-1, 1, 512, 512]         --
|    └─Conv2d: 2-10                      [-1, 1, 512, 512]         145
|    └─Identity: 2-11                    [-1, 1, 512, 512]         --
|    └─Activation: 2-12                  [-1, 1, 512, 512]         --
|    |    └─Identity: 3-14               [-1, 1, 512, 512]         --
==========================================================================================
Total params: 14,328,209
Trainable params: 14,328,209
Non-trainable params: 0
Total mult-adds (G): 9.46
==========================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 186.00
Params size (MB): 54.66
Estimated Total Size (MB): 243.66
==========================================================================================
Epcohs: 1
Training...



100%|██████████| 6/6 [00:07<00:00,  1.33s/it]
Testing...
100%|██████████| 4/4 [00:01<00:00,  2.24it/s]
  0%|          | 0/6 [00:00<?, ?it/s]
Training Outputs:
Total loss: 1.10, BCE: 0.65, Dice Score: 0.557818
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.05, BCE: 0.64, Dice Score: 0.595948
Epcohs: 2

 67%|██████▋   | 4/6 [00:01<00:00,  2.16it/s]
100%|██████████| 6/6 [00:02<00:00,  2.31it/s]
100%|██████████| 4/4 [00:01<00:00,  3.56it/s]
  0%|          | 0/6 [00:00<?, ?it/s]
Training Outputs:
Total loss: 0.86, BCE: 0.55, Dice Score: 0.686446
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 2.01, BCE: 1.76, Dice Score: 0.753284
Epcohs: 3


 83%|████████▎ | 5/6 [00:02<00:00,  2.52it/s]
Testing...
Training Outputs:
Total loss: 0.76, BCE: 0.51, Dice Score: 0.749315
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.97, BCE: 0.73, Dice Score: 0.756132
Epcohs: 4
100%|██████████| 6/6 [00:03<00:00,  1.52it/s]
100%|██████████| 4/4 [00:01<00:00,  3.68it/s]

 83%|████████▎ | 5/6 [00:02<00:00,  2.19it/s]
Testing...
Training Outputs:
Total loss: 0.70, BCE: 0.49, Dice Score: 0.791516
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.92, BCE: 1.63, Dice Score: 0.709263
Epcohs: 5
100%|██████████| 6/6 [00:02<00:00,  2.29it/s]
100%|██████████| 4/4 [00:00<00:00,  4.47it/s]

 50%|█████     | 3/6 [00:02<00:03,  1.04s/it]
100%|██████████| 6/6 [00:03<00:00,  1.59it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.08it/s]
Training Outputs:
Total loss: 0.71, BCE: 0.50, Dice Score: 0.788284
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.88, BCE: 0.65, Dice Score: 0.768775
Epcohs: 6
100%|██████████| 4/4 [00:00<00:00,  4.95it/s]

100%|██████████| 6/6 [00:03<00:00,  1.57it/s]
Testing...
Training Outputs:
Total loss: 0.64, BCE: 0.46, Dice Score: 0.820892
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.76, BCE: 0.58, Dice Score: 0.821731
Epcohs: 7
Training...
100%|██████████| 4/4 [00:00<00:00,  4.19it/s]

 83%|████████▎ | 5/6 [00:02<00:00,  1.78it/s]
Testing...
Training Outputs:
Total loss: 0.62, BCE: 0.46, Dice Score: 0.836647
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.70, BCE: 0.53, Dice Score: 0.831341
Epcohs: 8
100%|██████████| 6/6 [00:02<00:00,  2.08it/s]
100%|██████████| 4/4 [00:00<00:00,  4.25it/s]

 67%|██████▋   | 4/6 [00:02<00:01,  1.55it/s]
100%|██████████| 6/6 [00:03<00:00,  1.54it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  4.88it/s]
Training Outputs:
Total loss: 0.64, BCE: 0.47, Dice Score: 0.832383
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.67, BCE: 0.50, Dice Score: 0.829301
Epcohs: 9
100%|██████████| 4/4 [00:00<00:00,  4.78it/s]
 50%|█████     | 3/6 [00:01<00:01,  2.00it/s]
100%|██████████| 6/6 [00:03<00:00,  1.70it/s]
  0%|          | 0/4 [00:00<?, ?it/s]
Training Outputs:
Total loss: 0.60, BCE: 0.44, Dice Score: 0.836275
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.62, BCE: 0.46, Dice Score: 0.833353
Epcohs: 10
100%|██████████| 4/4 [00:00<00:00,  4.00it/s]
 33%|███▎      | 2/6 [00:00<00:01,  2.52it/s]ERROR:root:MultiThreadedGenerator: caught exception: (<class 'KeyboardInterrupt'>, KeyboardInterrupt(), <traceback object at 0x7f6011fc6948>)
 33%|███▎      | 2/6 [00:01<00:02,  1.41it/s]
Traceback (most recent call last):
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/batchgenerators/dataloading/multi_threaded_augmenter.py", line 206, in __next__
    item = self.__get_next_item()
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/batchgenerators/dataloading/multi_threaded_augmenter.py", line 197, in __get_next_item
    sleep(self.wait_time)
KeyboardInterrupt
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/IPython/core/interactiveshell.py", line 3343, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-2-6c34b8e2df23>", line 1, in <module>
    runfile('/home/kevinteng/Desktop/Gland-Segmentation/train.py', wdir='/home/kevinteng/Desktop/Gland-Segmentation')
  File "/snap/pycharm-professional/278/plugins/python/helpers/pydev/_pydev_bundle/pydev_umd.py", line 198, in runfile
    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script
  File "/snap/pycharm-professional/278/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/kevinteng/Desktop/Gland-Segmentation/train.py", line 137, in <module>
    train_output = train(model, optimizer)
  File "/home/kevinteng/Desktop/Gland-Segmentation/train.py", line 63, in train
    train_batch = next(train_gen)
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/batchgenerators/dataloading/multi_threaded_augmenter.py", line 224, in __next__
    raise KeyboardInterrupt
