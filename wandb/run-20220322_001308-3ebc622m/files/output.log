
  0%|          | 0/6 [00:00<?, ?it/s]
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
├─Encoder: 1-1                                [-1, 4, 512, 512]         --
|    └─SeparableConv2d: 2-1                   [-1, 4, 512, 512]         --
|    |    └─Conv2d: 3-1                       [-1, 3, 512, 512]         84
|    |    └─Conv2d: 3-2                       [-1, 4, 512, 512]         16
|    └─ResBlock: 2-2                          [-1, 4, 512, 512]         --
|    |    └─ConvBlock: 3-3                    [-1, 4, 512, 512]         176
|    |    └─ConvBlock: 3-4                    [-1, 4, 512, 512]         176
|    └─ModuleList: 2                          []                        --
|    |    └─ResBlock: 3-5                     [-1, 8, 256, 256]         1,532
|    |    └─ResBlock: 3-6                     [-1, 16, 128, 128]        5,976


 67%|██████▋   | 4/6 [00:06<00:01,  1.01it/s]
|    └─BatchNorm2d: 2-3                       [-1, 32, 64, 64]          64
|    └─ReLU: 2-4                              [-1, 32, 64, 64]          --
├─Decoder: 1-2                                [-1, 1, 512, 512]         --
|    └─ModuleList: 2                          []                        --
|    |    └─UpConvBlock: 3-8                  [-1, 16, 128, 128]        17,088
|    |    └─UpConvBlock: 3-9                  [-1, 8, 256, 256]         4,320
|    |    └─UpConvBlock: 3-10                 [-1, 4, 512, 512]         1,104
|    └─BatchNorm2d: 2-5                       [-1, 4, 512, 512]         8
|    └─ReLU: 2-6                              [-1, 4, 512, 512]         --
|    └─Conv2d: 2-7                            [-1, 1, 512, 512]         37
|    └─BatchNorm2d: 2-8                       [-1, 1, 512, 512]         2
===============================================================================================
Total params: 54,183
Trainable params: 54,183
Non-trainable params: 0
Total mult-adds (M): 33.98
===============================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 43.00
Params size (MB): 0.21
Estimated Total Size (MB): 46.21
===============================================================================================
Epcohs: 1
Training...
100%|██████████| 6/6 [00:08<00:00,  1.47s/it]
 75%|███████▌  | 3/4 [00:01<00:00,  2.72it/s]
Training Outputs:
Total loss: 1.29, BCE: 0.80, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.20, BCE: 0.70, Dice Loss: 0.50
Epcohs: 2
100%|██████████| 4/4 [00:01<00:00,  2.84it/s]
 33%|███▎      | 2/6 [00:00<00:01,  3.07it/s]
100%|██████████| 6/6 [00:02<00:00,  2.31it/s]
 50%|█████     | 2/4 [00:00<00:00,  3.17it/s]
Training Outputs:
Total loss: 1.31, BCE: 0.80, Dice Loss: 0.51
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.20, BCE: 0.69, Dice Loss: 0.51
Epcohs: 3
100%|██████████| 4/4 [00:01<00:00,  3.35it/s]

 67%|██████▋   | 4/6 [00:02<00:00,  2.34it/s]
100%|██████████| 6/6 [00:04<00:00,  1.28it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  4.46it/s]
Training Outputs:
Total loss: 1.27, BCE: 0.77, Dice Loss: 0.50
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.22, BCE: 0.69, Dice Loss: 0.52
Epcohs: 4
100%|██████████| 4/4 [00:00<00:00,  4.45it/s]
 33%|███▎      | 2/6 [00:00<00:01,  3.02it/s]
100%|██████████| 6/6 [00:03<00:00,  1.91it/s]
100%|██████████| 4/4 [00:00<00:00,  4.39it/s]
 50%|█████     | 3/6 [00:01<00:01,  2.37it/s]
Training Outputs:
Total loss: 1.23, BCE: 0.75, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.20, BCE: 0.69, Dice Loss: 0.51
Epcohs: 5

 67%|██████▋   | 4/6 [00:01<00:00,  2.59it/s]
100%|██████████| 6/6 [00:04<00:00,  1.22it/s]
 50%|█████     | 2/4 [00:00<00:00,  4.76it/s]
Training Outputs:
Total loss: 1.21, BCE: 0.72, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.20, BCE: 0.70, Dice Loss: 0.50
Epcohs: 6
100%|██████████| 4/4 [00:00<00:00,  4.54it/s]
100%|██████████| 6/6 [00:02<00:00,  2.17it/s]
 50%|█████     | 2/4 [00:00<00:00,  4.66it/s]
100%|██████████| 4/4 [00:00<00:00,  4.67it/s]
 33%|███▎      | 2/6 [00:01<00:02,  1.39it/s]
Training Outputs:
Total loss: 1.17, BCE: 0.70, Dice Loss: 0.47
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.21, BCE: 0.70, Dice Loss: 0.51
Epcohs: 7

 67%|██████▋   | 4/6 [00:02<00:00,  2.27it/s]
100%|██████████| 6/6 [00:04<00:00,  1.26it/s]
100%|██████████| 4/4 [00:00<00:00,  4.85it/s]
Training Outputs:
Total loss: 1.22, BCE: 0.72, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.21, BCE: 0.70, Dice Loss: 0.51
Epcohs: 8
Training...
 50%|█████     | 3/6 [00:01<00:01,  1.72it/s]
Testing...
Training Outputs:
Total loss: 1.19, BCE: 0.71, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.18, BCE: 0.70, Dice Loss: 0.48
Epcohs: 9
100%|██████████| 6/6 [00:02<00:00,  2.27it/s]
100%|██████████| 4/4 [00:00<00:00,  4.42it/s]


 67%|██████▋   | 4/6 [00:02<00:00,  2.00it/s]
100%|██████████| 6/6 [00:05<00:00,  1.08it/s]
 75%|███████▌  | 3/4 [00:00<00:00,  5.05it/s]
Training Outputs:
Total loss: 1.20, BCE: 0.71, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.18, BCE: 0.70, Dice Loss: 0.48
Epcohs: 10
100%|██████████| 4/4 [00:00<00:00,  4.83it/s]
 50%|█████     | 3/6 [00:01<00:01,  1.83it/s]
Testing...
Training Outputs:
Total loss: 1.20, BCE: 0.71, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
100%|██████████| 6/6 [00:02<00:00,  2.28it/s]
100%|██████████| 4/4 [00:00<00:00,  4.53it/s]
Epcohs: 11
Training...

 83%|████████▎ | 5/6 [00:03<00:00,  1.03it/s]
Testing...
Training Outputs:
Total loss: 1.17, BCE: 0.71, Dice Loss: 0.46
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.19, BCE: 0.71, Dice Loss: 0.48
Epcohs: 12
100%|██████████| 6/6 [00:04<00:00,  1.49it/s]
100%|██████████| 4/4 [00:00<00:00,  4.99it/s]

 50%|█████     | 3/6 [00:02<00:02,  1.00it/s]
Testing...
Training Outputs:
Total loss: 1.17, BCE: 0.70, Dice Loss: 0.47
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.17, BCE: 0.70, Dice Loss: 0.47
Epcohs: 13
100%|██████████| 6/6 [00:03<00:00,  1.75it/s]
100%|██████████| 4/4 [00:00<00:00,  4.99it/s]

 67%|██████▋   | 4/6 [00:02<00:00,  2.28it/s]
Testing...
Training Outputs:
Total loss: 1.22, BCE: 0.73, Dice Loss: 0.49
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.18, BCE: 0.71, Dice Loss: 0.47
Epcohs: 14
100%|██████████| 6/6 [00:04<00:00,  1.25it/s]
100%|██████████| 4/4 [00:00<00:00,  4.62it/s]

 67%|██████▋   | 4/6 [00:02<00:01,  1.61it/s]
Testing...
Training Outputs:
Total loss: 1.18, BCE: 0.71, Dice Loss: 0.47
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.22, BCE: 0.71, Dice Loss: 0.50
Epcohs: 15
100%|██████████| 6/6 [00:02<00:00,  2.13it/s]
100%|██████████| 4/4 [00:00<00:00,  4.94it/s]

 67%|██████▋   | 4/6 [00:02<00:01,  1.93it/s]
100%|██████████| 6/6 [00:04<00:00,  1.33it/s]
  0%|          | 0/4 [00:00<?, ?it/s]
Training Outputs:
Total loss: 1.17, BCE: 0.70, Dice Loss: 0.47
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.16, BCE: 0.70, Dice Loss: 0.46
Epcohs: 16
100%|██████████| 4/4 [00:00<00:00,  4.95it/s]

100%|██████████| 6/6 [00:03<00:00,  1.87it/s]
100%|██████████| 4/4 [00:00<00:00,  4.61it/s]
 17%|█▋        | 1/6 [00:00<00:03,  1.56it/s]
Testing...
Training Outputs:
Total loss: 1.20, BCE: 0.72, Dice Loss: 0.48
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.17, BCE: 0.71, Dice Loss: 0.46
Epcohs: 17

100%|██████████| 6/6 [00:04<00:00,  1.34it/s]
 25%|██▌       | 1/4 [00:00<00:00,  5.65it/s]
100%|██████████| 4/4 [00:00<00:00,  4.88it/s]
 33%|███▎      | 2/6 [00:00<00:01,  3.14it/s]
Training Outputs:
Total loss: 1.19, BCE: 0.71, Dice Loss: 0.48
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.14, BCE: 0.70, Dice Loss: 0.44
Epcohs: 18
100%|██████████| 6/6 [00:02<00:00,  2.18it/s]
 50%|█████     | 2/4 [00:00<00:00,  4.23it/s]
100%|██████████| 4/4 [00:00<00:00,  4.41it/s]
 33%|███▎      | 2/6 [00:01<00:02,  1.54it/s]
Training Outputs:
Total loss: 1.18, BCE: 0.71, Dice Loss: 0.47
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.20, BCE: 0.71, Dice Loss: 0.48
Epcohs: 19

100%|██████████| 6/6 [00:04<00:00,  1.40it/s]
100%|██████████| 4/4 [00:00<00:00,  5.12it/s]
  0%|          | 0/6 [00:00<?, ?it/s]
Testing...
Training Outputs:
Total loss: 1.18, BCE: 0.70, Dice Loss: 0.48
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.17, BCE: 0.71, Dice Loss: 0.46
Epcohs: 20

100%|██████████| 6/6 [00:02<00:00,  2.18it/s]
100%|██████████| 4/4 [00:00<00:00,  4.62it/s]
  0%|          | 0/6 [00:00<?, ?it/s]
Testing...
Training Outputs:
Total loss: 1.16, BCE: 0.70, Dice Loss: 0.46
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.18, BCE: 0.71, Dice Loss: 0.46
Epcohs: 21

 67%|██████▋   | 4/6 [00:02<00:00,  2.01it/s]
100%|██████████| 6/6 [00:05<00:00,  1.06it/s]
 50%|█████     | 2/4 [00:00<00:00,  4.75it/s]
Training Outputs:
Total loss: 1.17, BCE: 0.71, Dice Loss: 0.47
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.19, BCE: 0.72, Dice Loss: 0.47
Epcohs: 22
100%|██████████| 4/4 [00:00<00:00,  4.96it/s]
 50%|█████     | 3/6 [00:00<00:00,  3.13it/s]
Testing...
Training Outputs:
Total loss: 1.16, BCE: 0.69, Dice Loss: 0.46
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.19, BCE: 0.72, Dice Loss: 0.48
Epcohs: 23
100%|██████████| 6/6 [00:02<00:00,  2.51it/s]
100%|██████████| 4/4 [00:00<00:00,  4.75it/s]


100%|██████████| 6/6 [00:05<00:00,  1.16it/s]
100%|██████████| 4/4 [00:00<00:00,  4.72it/s]
  0%|          | 0/6 [00:00<?, ?it/s]
Testing...
Training Outputs:
Total loss: 1.19, BCE: 0.71, Dice Loss: 0.48
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.18, BCE: 0.72, Dice Loss: 0.46
Epcohs: 24
Training...
Traceback (most recent call last):
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/IPython/core/interactiveshell.py", line 3343, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-2-6dc7710c7f93>", line 1, in <module>
    runfile('/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py', wdir='/home/kevinteng/Desktop/Gland-Segmentation')
  File "/snap/pycharm-professional/278/plugins/python/helpers/pydev/_pydev_bundle/pydev_umd.py", line 198, in runfile
    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script
  File "/snap/pycharm-professional/278/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py", line 188, in <module>
    main()
  File "/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py", line 146, in main
    train_output = train(model, optimizer)
  File "/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py", line 82, in train
    optimizer.step()
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/optim/optimizer.py", line 88, in wrapper
    return func(*args, **kwargs)
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/optim/adam.py", line 118, in step
    eps=group['eps'])
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/optim/_functional.py", line 94, in adam
    denom = (exp_avg_sq.sqrt() / math.sqrt(bias_correction2)).add_(eps)
