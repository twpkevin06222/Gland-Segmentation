
  5%|▍         | 2/43 [00:01<00:28,  1.42it/s]
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
├─Encoder: 1-1                                [-1, 64, 512, 512]        --
|    └─SeparableConv2d: 2-1                   [-1, 64, 512, 512]        --
|    |    └─Conv2d: 3-1                       [-1, 3, 512, 512]         84
|    |    └─Conv2d: 3-2                       [-1, 64, 512, 512]        256
|    └─ResBlock: 2-2                          [-1, 64, 512, 512]        --
|    |    └─ConvBlock: 3-3                    [-1, 64, 512, 512]        41,216
|    |    └─ConvBlock: 3-4                    [-1, 64, 512, 512]        41,216
|    └─ModuleList: 2                          []                        --
|    |    └─ResBlock: 3-5                     [-1, 128, 256, 256]       373,952
|    |    └─ResBlock: 3-6                     [-1, 256, 128, 128]       1,493,376
|    |    └─ResBlock: 3-7                     [-1, 512, 64, 64]         5,968,640
|    └─BatchNorm2d: 2-3                       [-1, 512, 64, 64]         1,024
|    └─ReLU: 2-4                              [-1, 512, 64, 64]         --
├─Decoder: 1-2                                [-1, 1, 512, 512]         --
|    └─ModuleList: 2                          []                        --
|    |    └─UpConvBlock: 3-8                  [-1, 256, 128, 128]       4,328,448
|    |    └─UpConvBlock: 3-9                  [-1, 128, 256, 256]       1,082,880
|    |    └─UpConvBlock: 3-10                 [-1, 64, 512, 512]        271,104
|    └─BatchNorm2d: 2-5                       [-1, 64, 512, 512]        128
|    └─ReLU: 2-6                              [-1, 64, 512, 512]        --
|    └─Conv2d: 2-7                            [-1, 1, 512, 512]         577
|    └─BatchNorm2d: 2-8                       [-1, 1, 512, 512]         2
===============================================================================================
Total params: 13,602,903
Trainable params: 13,602,903
Non-trainable params: 0
Total mult-adds (M): 263.41
===============================================================================================
Input size (MB): 3.00
Forward/backward pass size (MB): 538.00
Params size (MB): 51.89
Estimated Total Size (MB): 592.89
===============================================================================================
Epcohs: 1








 91%|█████████ | 39/43 [00:17<00:01,  2.31it/s]
100%|██████████| 43/43 [00:19<00:00,  2.22it/s]

 67%|██████▋   | 20/30 [00:02<00:01,  8.01it/s]
Training Outputs:
Total loss: 1.17, BCE: 0.69, Dice Loss: 0.48
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.78, BCE: 1.43, Dice Loss: 0.35
Epcohs: 2
100%|██████████| 30/30 [00:03<00:00,  8.16it/s]









 98%|█████████▊| 42/43 [00:18<00:00,  2.32it/s]
100%|██████████| 43/43 [00:18<00:00,  2.32it/s]

100%|██████████| 30/30 [00:03<00:00,  8.10it/s]
  7%|▋         | 3/43 [00:01<00:17,  2.35it/s]
Training Outputs:
Total loss: 1.08, BCE: 0.64, Dice Loss: 0.43
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.24, BCE: 0.91, Dice Loss: 0.33
Epcohs: 3








 93%|█████████▎| 40/43 [00:17<00:01,  2.29it/s]
100%|██████████| 43/43 [00:18<00:00,  2.30it/s]

 73%|███████▎  | 22/30 [00:02<00:01,  7.95it/s]
Training Outputs:
Total loss: 1.07, BCE: 0.64, Dice Loss: 0.43
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.19, BCE: 0.87, Dice Loss: 0.33
Epcohs: 4
100%|██████████| 30/30 [00:03<00:00,  8.07it/s]









 98%|█████████▊| 42/43 [00:18<00:00,  2.29it/s]
100%|██████████| 43/43 [00:18<00:00,  2.29it/s]

100%|██████████| 30/30 [00:03<00:00,  7.98it/s]
  7%|▋         | 3/43 [00:01<00:17,  2.33it/s]
Training Outputs:
Total loss: 1.05, BCE: 0.64, Dice Loss: 0.41
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.27, BCE: 0.86, Dice Loss: 0.41
Epcohs: 5








100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 23%|██▎       | 7/30 [00:00<00:02,  8.61it/s]

 77%|███████▋  | 23/30 [00:02<00:00,  7.94it/s]
Training Outputs:
Total loss: 1.02, BCE: 0.62, Dice Loss: 0.40
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.27, BCE: 0.86, Dice Loss: 0.41
Epcohs: 6
100%|██████████| 30/30 [00:03<00:00,  8.07it/s]








 88%|████████▊ | 38/43 [00:16<00:02,  2.31it/s]
100%|██████████| 43/43 [00:18<00:00,  2.31it/s]

 57%|█████▋    | 17/30 [00:02<00:01,  7.95it/s]
Training Outputs:
Total loss: 1.05, BCE: 0.64, Dice Loss: 0.41
----------------------------------------------------------------------------------------------------
Validation Outputs:

100%|██████████| 30/30 [00:03<00:00,  8.03it/s]
Epcohs: 7
Training...








 95%|█████████▌| 41/43 [00:17<00:00,  2.31it/s]
100%|██████████| 43/43 [00:18<00:00,  2.31it/s]

 87%|████████▋ | 26/30 [00:03<00:00,  7.99it/s]
Training Outputs:
Total loss: 1.02, BCE: 0.62, Dice Loss: 0.40
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.09, BCE: 0.66, Dice Loss: 0.43
Epcohs: 8
100%|██████████| 30/30 [00:03<00:00,  8.15it/s]








100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 13%|█▎        | 4/30 [00:00<00:02,  9.47it/s]

100%|██████████| 30/30 [00:03<00:00,  8.12it/s]
  0%|          | 0/43 [00:00<?, ?it/s]
Training Outputs:
Total loss: 1.02, BCE: 0.61, Dice Loss: 0.40
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.06, BCE: 0.67, Dice Loss: 0.40
Epcohs: 9









100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 43%|████▎     | 13/30 [00:01<00:02,  8.01it/s]

100%|██████████| 30/30 [00:03<00:00,  8.12it/s]
  7%|▋         | 3/43 [00:01<00:16,  2.37it/s]
Training Outputs:
Total loss: 1.02, BCE: 0.63, Dice Loss: 0.39
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.10, BCE: 0.70, Dice Loss: 0.40
Epcohs: 10








100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 23%|██▎       | 7/30 [00:00<00:02,  8.61it/s]

100%|██████████| 30/30 [00:03<00:00,  8.11it/s]
  2%|▏         | 1/43 [00:00<00:15,  2.72it/s]
Training Outputs:
Total loss: 1.04, BCE: 0.64, Dice Loss: 0.40
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.15, BCE: 0.77, Dice Loss: 0.38
Epcohs: 11









100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 50%|█████     | 15/30 [00:01<00:01,  7.91it/s]

100%|██████████| 30/30 [00:03<00:00,  8.03it/s]
  7%|▋         | 3/43 [00:01<00:17,  2.35it/s]
Training Outputs:
Total loss: 1.01, BCE: 0.62, Dice Loss: 0.39
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.02, BCE: 0.63, Dice Loss: 0.39
Epcohs: 12








100%|██████████| 43/43 [00:18<00:00,  2.31it/s]
 27%|██▋       | 8/30 [00:00<00:02,  8.34it/s]

100%|██████████| 30/30 [00:03<00:00,  8.03it/s]
  5%|▍         | 2/43 [00:00<00:17,  2.41it/s]
Training Outputs:
Total loss: 1.05, BCE: 0.65, Dice Loss: 0.41
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.12, BCE: 0.68, Dice Loss: 0.45
Epcohs: 13








100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
  7%|▋         | 2/30 [00:00<00:02, 12.98it/s]

100%|██████████| 30/30 [00:03<00:00,  8.04it/s]
  0%|          | 0/43 [00:00<?, ?it/s]
Training Outputs:
Total loss: 1.06, BCE: 0.64, Dice Loss: 0.42
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.13, BCE: 0.69, Dice Loss: 0.44
Epcohs: 14









100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 40%|████      | 12/30 [00:01<00:02,  7.98it/s]

100%|██████████| 30/30 [00:03<00:00,  8.10it/s]
  7%|▋         | 3/43 [00:01<00:17,  2.34it/s]
Training Outputs:
Total loss: 1.04, BCE: 0.64, Dice Loss: 0.40
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.05, BCE: 0.64, Dice Loss: 0.40
Epcohs: 15








100%|██████████| 43/43 [00:18<00:00,  2.29it/s]
 13%|█▎        | 4/30 [00:00<00:02,  9.49it/s]

100%|██████████| 30/30 [00:03<00:00,  7.56it/s]
  0%|          | 0/43 [00:00<?, ?it/s]
Training Outputs:
Total loss: 1.02, BCE: 0.63, Dice Loss: 0.40
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.07, BCE: 0.65, Dice Loss: 0.42
Epcohs: 16









100%|██████████| 43/43 [00:20<00:00,  2.14it/s]
  7%|▋         | 2/30 [00:00<00:02, 12.96it/s]

100%|██████████| 30/30 [00:03<00:00,  8.07it/s]
  0%|          | 0/43 [00:00<?, ?it/s]
Training Outputs:
Total loss: 1.00, BCE: 0.62, Dice Loss: 0.38
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.08, BCE: 0.74, Dice Loss: 0.33
Epcohs: 17









100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 40%|████      | 12/30 [00:01<00:02,  7.99it/s]

100%|██████████| 30/30 [00:03<00:00,  8.07it/s]
  7%|▋         | 3/43 [00:01<00:17,  2.34it/s]
Training Outputs:
Total loss: 1.01, BCE: 0.63, Dice Loss: 0.37
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.12, BCE: 0.67, Dice Loss: 0.45
Epcohs: 18








100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 17%|█▋        | 5/30 [00:00<00:02,  8.92it/s]

100%|██████████| 30/30 [00:03<00:00,  7.96it/s]
  2%|▏         | 1/43 [00:00<00:16,  2.56it/s]
Training Outputs:
Total loss: 1.00, BCE: 0.62, Dice Loss: 0.38
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.21, BCE: 0.76, Dice Loss: 0.46
Epcohs: 19









100%|██████████| 43/43 [00:18<00:00,  2.31it/s]
 50%|█████     | 15/30 [00:01<00:01,  7.99it/s]

100%|██████████| 30/30 [00:03<00:00,  8.06it/s]
  9%|▉         | 4/43 [00:01<00:16,  2.33it/s]
Training Outputs:
Total loss: 0.98, BCE: 0.61, Dice Loss: 0.37
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.06, BCE: 0.65, Dice Loss: 0.41
Epcohs: 20








100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
 30%|███       | 9/30 [00:01<00:02,  8.20it/s]

100%|██████████| 30/30 [00:03<00:00,  8.05it/s]
  2%|▏         | 1/43 [00:00<00:15,  2.66it/s]
Training Outputs:
Total loss: 1.00, BCE: 0.62, Dice Loss: 0.38
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.98, BCE: 0.62, Dice Loss: 0.36
Epcohs: 21









100%|██████████| 43/43 [00:18<00:00,  2.30it/s]
Testing...
100%|██████████| 30/30 [00:03<00:00,  8.11it/s]
  0%|          | 0/43 [00:00<?, ?it/s]
Training Outputs:
Total loss: 0.97, BCE: 0.61, Dice Loss: 0.36
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.05, BCE: 0.63, Dice Loss: 0.43
Epcohs: 22









 95%|█████████▌| 41/43 [00:17<00:00,  2.29it/s]
100%|██████████| 43/43 [00:18<00:00,  2.31it/s]

100%|██████████| 30/30 [00:03<00:00,  8.13it/s]
  7%|▋         | 3/43 [00:01<00:17,  2.32it/s]
Training Outputs:
Total loss: 0.97, BCE: 0.61, Dice Loss: 0.36
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 0.99, BCE: 0.64, Dice Loss: 0.35
Epcohs: 23








 91%|█████████ | 39/43 [00:16<00:01,  2.29it/s]
100%|██████████| 43/43 [00:18<00:00,  2.30it/s]

 70%|███████   | 21/30 [00:02<00:01,  7.96it/s]
Training Outputs:
Total loss: 0.96, BCE: 0.60, Dice Loss: 0.36
----------------------------------------------------------------------------------------------------
Validation Outputs:
Total loss: 1.06, BCE: 0.67, Dice Loss: 0.39
Epcohs: 24
100%|██████████| 30/30 [00:03<00:00,  8.17it/s]


 33%|███▎      | 14/43 [00:06<00:12,  2.25it/s]
Traceback (most recent call last):
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/IPython/core/interactiveshell.py", line 3343, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "<ipython-input-2-6dc7710c7f93>", line 1, in <module>
    runfile('/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py', wdir='/home/kevinteng/Desktop/Gland-Segmentation')
  File "/snap/pycharm-professional/278/plugins/python/helpers/pydev/_pydev_bundle/pydev_umd.py", line 198, in runfile
    pydev_imports.execfile(filename, global_vars, local_vars)  # execute the script
  File "/snap/pycharm-professional/278/plugins/python/helpers/pydev/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc)
  File "/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py", line 187, in <module>
    main()
  File "/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py", line 145, in main
    train_output = train(model, optimizer)
  File "/home/kevinteng/Desktop/Gland-Segmentation/train_custom.py", line 82, in train
    optimizer.step()
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/optim/optimizer.py", line 88, in wrapper
    return func(*args, **kwargs)
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/autograd/grad_mode.py", line 28, in decorate_context
    return func(*args, **kwargs)
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/optim/adam.py", line 118, in step
    eps=group['eps'])
  File "/home/kevinteng/envs/tfenv/lib/python3.6/site-packages/torch/optim/_functional.py", line 94, in adam
    denom = (exp_avg_sq.sqrt() / math.sqrt(bias_correction2)).add_(eps)
